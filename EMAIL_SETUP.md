# 이메일 알림 설정 가이드

광고주 등록 시 이메일 알림이 발송되지 않는 문제를 해결하기 위한 설정 가이드입니다.

## 문제 원인

1. **이메일 인증 정보 누락**: `.env.local` 파일에 Gmail 인증 정보가 설정되지 않음
2. **구글 시트 매핑 누락**: 땡겨요 플랫폼에 대한 시트 매핑이 누락되어 있었음 (수정 완료)

## 해결 방법

### 1. Gmail 앱 비밀번호 생성

1. Gmail 계정(ceo@wiztheplanning.com)으로 로그인
2. Google 계정 설정 → 보안 → 2단계 인증 활성화
3. 2단계 인증 활성화 후, "앱 비밀번호" 생성
   - 앱 선택: 메일
   - 기기 선택: 기타(사용자 지정 이름)
   - 이름 입력: "리뷰프로그램"
4. 생성된 16자리 앱 비밀번호 복사

### 2. 환경 변수 설정

`.env.local` 파일에 다음 내용을 추가하거나 수정:

```
# 이메일 설정 (Gmail 앱 비밀번호 필요)
EMAIL_USER=ceo@wiztheplanning.com
EMAIL_PASS=생성한_16자리_앱_비밀번호 (띄어쓰기 없이 입력)
```

예시:
```
EMAIL_PASS=abcd efgh ijkl mnop  # 잘못된 예시 (띄어쓰기 있음)
EMAIL_PASS=abcdefghijklmnop      # 올바른 예시 (띄어쓰기 없음)
```

### 3. 서버 재시작

환경 변수를 변경한 후에는 Next.js 개발 서버를 재시작해야 합니다:

```bash
# 현재 실행 중인 서버 중지 (Ctrl + C)
# 서버 재시작
npm run dev
```

## 이메일 발송 프로세스

1. **광고주 등록**: 관리자가 광고주 관리 페이지에서 새 광고주 등록
2. **구글 시트 동기화**: 플랫폼 정보가 자동으로 구글 시트에 동기화
3. **이메일 알림 발송**: 동기화 성공/실패 시 설정된 이메일로 알림 발송

### 이메일 수신자

현재 다음 이메일 주소로 알림이 발송됩니다:
- ceo@wiztheplanning.com
- qpqpqp@wiztheplanning.com
- smartwater@wiztheplanning.com

수신자를 변경하려면 `/lib/email-service.ts` 파일의 `NOTIFICATION_EMAILS` 배열을 수정하세요.

## 테스트 방법

1. 환경 변수 설정 완료 후 서버 재시작
2. 광고주 관리 페이지에서 테스트 광고주 등록
3. 플랫폼 정보를 최소 1개 이상 입력
4. 등록 완료 후 이메일 수신 확인

## 문제 해결

### 이메일이 여전히 오지 않는 경우

1. **서버 로그 확인**: 콘솔에서 이메일 관련 로그 확인
   - `⚠️ 이메일 설정이 완료되지 않아 이메일 전송을 건너뜁니다.` → 환경 변수 설정 확인
   - `❌ 이메일 전송 실패:` → Gmail 앱 비밀번호 확인

2. **구글 시트 동기화 확인**: 
   - 구글 시트에 데이터가 추가되는지 확인
   - 시트 ID가 올바른지 확인 (`.env.local`의 `GOOGLE_SHEETS_SPREADSHEET_ID`)

3. **Gmail 보안 설정**:
   - 2단계 인증이 활성화되어 있는지 확인
   - 앱 비밀번호가 만료되지 않았는지 확인

### 추가 디버깅

브라우저 개발자 도구의 네트워크 탭에서 API 응답 확인:
- `/api/clients` POST 요청의 응답 확인
- 콘솔 로그에서 동기화 관련 메시지 확인

## 주의사항

- 앱 비밀번호는 공백 없이 입력해야 합니다
- 환경 변수 변경 후 반드시 서버를 재시작해야 합니다
- Gmail 계정의 보안 설정에 따라 추가 인증이 필요할 수 있습니다